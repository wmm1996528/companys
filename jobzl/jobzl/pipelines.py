# -*- coding: utf-8 -*-

# Define your item pipelines here
#
# Don't forget to add your pipeline to the ITEM_PIPELINES setting
# See: https://doc.scrapy.org/en/latest/topics/item-pipeline.html

from pymongo import MongoClient
import pymongo

class JobzlPipeline(object):
	db = MongoClient().companys.zhilian


	def process_item(self, item, spider):
		data = dict(item)
		try:
			self.db.insert(data)
		except pymongo.errors.DuplicateKeyError:
			pass
		return item
# db = MongoClient().companys.zhilian
# d = [{'size': '20人以下', 'zhizhao': '', 'hangye': '', 'type_': '民营', '_id': '杭州来恩哲电子科技有限公司'}, {'size': '20-99人', 'zhizhao': '', 'hangye': '', 'type_': '合资', '_id': '湖北稳派文化传播有限公司'}, {'size': '20-99人', 'zhizhao': '', 'hangye': '', 'type_': '民营', '_id': '杭州科腾信息技术有限公司'}, {'size': '10000人以上', 'zhizhao': '', 'hangye': '', 'type_': '民营', '_id': '平安普惠投资咨询有限公司南昌红谷滩分公司'}, {'size': '100-499人', 'zhizhao': '', 'hangye': '', 'type_': '民营', '_id': '深圳市云商通网络科技有限公司'}, {'size': '20-99人', 'zhizhao': '', 'hangye': '', 'type_': '国企', '_id': '国药集团新疆医学器材有限公司'}, {'size': '20-99人', 'zhizhao': '', 'hangye': '', 'type_': '民营', '_id': '青岛淼盾八哥网络科技有限公司'}, {'size': '100-499人', 'zhizhao': '', 'hangye': '', 'type_': '民营', '_id': '宁波方太营销有限公司南通服务部'}, {'size': '20-99人', 'zhizhao': '', 'hangye': '', 'type_': '股份制企业', '_id': '杭州中驰汽车服务有限公司'}, {'size': '1000-9999人', 'zhizhao': '', 'hangye': '', 'type_': '合资', '_id': '深圳市珍爱网信息技术有限公司'}, {'size': '20-99人', 'zhizhao': '', 'hangye': '', 'type_': '民营', '_id': '北京哈哈镜电子商务有限公司'}, {'size': '500-999人', 'zhizhao': '', 'hangye': '', 'type_': '民营', '_id': '武汉众汇信资产管理有限公司'}, {'size': '100-499人', 'zhizhao': '', 'hangye': '', 'type_': '民营', '_id': '天津富源水利工程有限公司'}, {'size': '500-999人', 'zhizhao': '', 'hangye': '', 'type_': '民营', '_id': '沈阳米田商贸有限公司'}, {'size': '20-99人', 'zhizhao': '', 'hangye': '', 'type_': '股份制企业', '_id': '北京伊美源泉国际美容连锁有限公司'}, {'size': '20-99人', 'zhizhao': '', 'hangye': '', 'type_': '民营', '_id': '广州伊风贸易有限公司'}, {'size': '20-99人', 'zhizhao': '', 'hangye': '', 'type_': '国企', '_id': '内蒙古景晟房地产有限公司'}, {'size': '20-99人', 'zhizhao': '', 'hangye': '', 'type_': '国企', '_id': '咸阳中兵机电装备制造有限责任公司'}, {'size': '1000-9999人', 'zhizhao': '', 'hangye': '', 'type_': '民营', '_id': '北京瑞祥佳艺建筑装饰工程有限公司宁波分公司'}, {'size': '100-499人', 'zhizhao': '', 'hangye': '', 'type_': '其它', '_id': '荣盛建设工程有限公司市政分公司'}, {'size': '100-499人', 'zhizhao': '', 'hangye': '', 'type_': '民营', '_id': '海天工程咨询有限公司'}, {'size': '20-99人', 'zhizhao': '', 'hangye': '', 'type_': '民营', '_id': '陕西中为融资担保有限公司'}, {'size': '20-99人', 'zhizhao': '', 'hangye': '', 'type_': '', '_id': '江苏十一先森生态农业科技有限公司'}, {'size': '100-499人', 'zhizhao': '', 'hangye': '', 'type_': '民营', '_id': '广元果王食品有限责任公司'}, {'size': '100-499人', 'zhizhao': '', 'hangye': '', 'type_': '民营', '_id': '冀北中原园林有限公司'}, {'size': '100-499人', 'zhizhao': '', 'hangye': '', 'type_': '民营', '_id': '深圳市思学佳教育有限公司'}, {'size': '500-999人', 'zhizhao': '', 'hangye': '', 'type_': '上市公司', '_id': '浙江美诺华药物化学有限公司'}, {'size': '20-99人', 'zhizhao': '', 'hangye': '', 'type_': '民营', '_id': '四川宇途国际旅行社有限公司'}, {'size': '10000人以上', 'zhizhao': '', 'hangye': '', 'type_': '民营', '_id': '英孚教育'}, {'size': '100-499人', 'zhizhao': '', 'hangye': '', 'type_': '外商独资', '_id': '巨庸安晋机械设备（上海）有限公司'}, {'size': '10000人以上', 'zhizhao': '', 'hangye': '', 'type_': '股份制企业', '_id': '云南国强商贸有限公司'}, {'size': '20-99人', 'zhizhao': '', 'hangye': '', 'type_': '民营', '_id': '长春市二月二文化传媒有限公司'}, {'size': '100-499人', 'zhizhao': '', 'hangye': '', 'type_': '民营', '_id': '长春市绘美时光教育咨询有限公司'}, {'size': '20-99人', 'zhizhao': '', 'hangye': '', 'type_': '外商独资', '_id': '希恩菲(北京)科贸有限公司'}, {'size': '100-499人', 'zhizhao': '', 'hangye': '', 'type_': '国企', '_id': '北京新航城控股有限公司'}, {'size': '1000-9999人', 'zhizhao': '', 'hangye': '', 'type_': '民营', '_id': '云南众合实业有限公司'}, {'size': '20人以下', 'zhizhao': '', 'hangye': '', 'type_': '民营', '_id': '江苏升亨电子科技有限公司'}, {'size': '10000人以上', 'zhizhao': '', 'hangye': '', 'type_': '股份制企业', '_id': '内蒙古伊利实业集团股份有限公司'}, {'size': '20-99人', 'zhizhao': '', 'hangye': '', 'type_': '股份制企业', '_id': '河南际州资产管理有限公司'}, {'size': '100-499人', 'zhizhao': '', 'hangye': '', 'type_': '民营', '_id': '山东天卓财务咨询有限公司'}, {'size': '20-99人', 'zhizhao': '', 'hangye': '', 'type_': '民营', '_id': '沈阳天圣伟业电子有限公司'}, {'size': '20-99人', 'zhizhao': '', 'hangye': '', 'type_': '民营', '_id': '湖北一点设计有限公司'}, {'size': '20-99人', 'zhizhao': '', 'hangye': '', 'type_': '民营', '_id': '日照懒懒文化传媒有限公司'}, {'size': '20人以下', 'zhizhao': '', 'hangye': '', 'type_': '民营', '_id': '山东银启律师事务所'}, {'size': '20-99人', 'zhizhao': '', 'hangye': '', 'type_': '股份制企业', '_id': '长沙博健生物科技有限公司'}, {'size': '100-499人', 'zhizhao': '', 'hangye': '', 'type_': '民营', '_id': '泉州市长兴化工材料有限公司'}, {'size': '1000-9999人', 'zhizhao': '', 'hangye': '', 'type_': '股份制企业', '_id': '中国平安人寿保险股份有限公司济南电话销售中心徐同刚部门'}, {'size': '1000-9999人', 'zhizhao': '', 'hangye': '', 'type_': '民营', '_id': '金明区小龙塑料制品商行'}, {'size': '20-99人', 'zhizhao': '', 'hangye': '', 'type_': '民营', '_id': '北京华审金建工程造价咨询有限公司山东分公司'}, {'size': '20-99人', 'zhizhao': '', 'hangye': '', 'type_': '其它', '_id': '威海在远自动化设备有限公司'}, {'size': '20-99人', 'zhizhao': '', 'hangye': '', 'type_': '合资', '_id': '北京爱林特立科技有限公司'}, {'size': '10000人以上', 'zhizhao': '', 'hangye': '', 'type_': '民营', '_id': '北京字节跳动科技有限公司'}, {'size': '10000人以上', 'zhizhao': '', 'hangye': '', 'type_': '上市公司', '_id': '长春英才添翼科技有限公司'}, {'size': '20-99人', 'zhizhao': '', 'hangye': '', 'type_': '民营', '_id': '义乌市敏淘电子商务有限公司'}, {'size': '100-499人', 'zhizhao': '', 'hangye': '', 'type_': '', '_id': '郑州好想你酒店管理有限公司'}, {'size': '20-99人', 'zhizhao': '', 'hangye': '', 'type_': '', '_id': '辽宁元如源食品有限责任公司'}, {'size': '20-99人', 'zhizhao': '', 'hangye': '', 'type_': '民营', '_id': '深圳七朵童爱实业有限公司'}, {'size': '20-99人', 'zhizhao': '', 'hangye': '', 'type_': '民营', '_id': '浙江模德石化有限公司'}, {'size': '', 'zhizhao': '', 'hangye': '', 'type_': '民营', '_id': '内蒙古初晟信息技术有限公司'}, {'size': '100-499人', 'zhizhao': '', 'hangye': '', 'type_': '股份制企业', '_id': '山东中关创业信息科技股份有限公司'}, {'size': '100-499人', 'zhizhao': '', 'hangye': '', 'type_': '合资', '_id': '富登小额贷款(重庆)有限公司'}, {'size': '100-499人', 'zhizhao': '', 'hangye': '', 'type_': '国企', '_id': '央视国际视频通讯有限公司'}, {'size': '100-499人', 'zhizhao': '', 'hangye': '', 'type_': '民营', '_id': '北京五养堂健康管理有限公司'}, {'size': '100-499人', 'zhizhao': '', 'hangye': '', 'type_': '民营', '_id': '厦门春来宝资产管理有限公司'}, {'size': '20-99人', 'zhizhao': '', 'hangye': '', 'type_': '律师事务所', '_id': '广西创想律师事务所'}, {'size': '10000人以上', 'zhizhao': '', 'hangye': '', 'type_': '民营', '_id': '北京字节跳动科技有限公司'}, {'size': '1000-9999人', 'zhizhao': '', 'hangye': '', 'type_': '其它', '_id': '华福证券有限责任公司兰州庆阳路证券营业部'}, {'size': '20-99人', 'zhizhao': '', 'hangye': '', 'type_': '民营', '_id': '合肥市博骏教育咨询有限公司成都分公司'}, {'size': '20-99人', 'zhizhao': '', 'hangye': '', 'type_': '合资', '_id': '陕西中和通达汽车服务有限公司'}, {'size': '1000-9999人', 'zhizhao': '', 'hangye': '', 'type_': '民营', '_id': '平顶山清艳教育'}, {'size': '20-99人', 'zhizhao': '', 'hangye': '', 'type_': '民营', '_id': '北京建宇鑫盛机电设备有限责任公司'}, {'size': '20-99人', 'zhizhao': '', 'hangye': '', 'type_': '国企', '_id': '贵州智通天下信息技术有限公司'}, {'size': '20-99人', 'zhizhao': '', 'hangye': '', 'type_': '民营', '_id': '商丘多美工贸有限公司'}, {'size': '100-499人', 'zhizhao': '', 'hangye': '', 'type_': '民营', '_id': '河南金隆珠宝有限公司'}, {'size': '20人以下', 'zhizhao': '', 'hangye': '', 'type_': '民营', '_id': '天津玺汇企业管理咨询服务有限公司'}, {'size': '500-999人', 'zhizhao': '', 'hangye': '', 'type_': '民营', '_id': '武汉华美整形外科医院有限公司光谷世界城医疗美容门诊部分公司'}, {'size': '20人以下', 'zhizhao': '', 'hangye': '', 'type_': '其它', '_id': '石家庄天泰安防设备有限公司'}, {'size': '20-99人', 'zhizhao': '', 'hangye': '', 'type_': '民营', '_id': '特素生物科技(天津)有限公司'}, {'size': '100-499人', 'zhizhao': '', 'hangye': '', 'type_': '民营', '_id': '平安普惠投资咨询有限公司沈阳市府大路分公司'}, {'size': '100-499人', 'zhizhao': '', 'hangye': '', 'type_': '民营', '_id': '石家庄眼科医院有限公司'}, {'size': '1000-9999人', 'zhizhao': '', 'hangye': '', 'type_': '民营', '_id': '北京爸爸的选择科技有限公司'}, {'size': '100-499人', 'zhizhao': '', 'hangye': '', 'type_': '民营', '_id': '沈阳开普医疗健康管理有限公司'}, {'size': '20-99人', 'zhizhao': '', 'hangye': '', 'type_': '民营', '_id': '西安派菲克信息技术服务有限公司'}, {'size': '', 'zhizhao': '', 'hangye': '', 'type_': '外商独资', '_id': '穆旭贸易(上海)有限公司'}, {'size': '500-999人', 'zhizhao': '', 'hangye': '', 'type_': '民营', '_id': '甘肃九龙房地产开发有限公司'}, {'size': '100-499人', 'zhizhao': '', 'hangye': '', 'type_': '民营', '_id': '宁波市爱凯国际贸易有限公司'}, {'size': '20-99人', 'zhizhao': '', 'hangye': '', 'type_': '合资', '_id': '徐州高动商务服务有限公司'}, {'size': '1000-9999人', 'zhizhao': '', 'hangye': '', 'type_': '股份制企业', '_id': '南京我爱我家房屋租赁置换有限公司'}, {'size': '100-499人', 'zhizhao': '', 'hangye': '', 'type_': '民营', '_id': '西安雅润企业管理咨询有限公司'}, {'size': '10000人以上', 'zhizhao': '', 'hangye': '', 'type_': '上市公司', '_id': '同方股份有限公司'}]
# for i in d:
# 	print(i['_id'])
# db.insert_many(d)
# for i in d:
# 	print(type(i))
# 	try:
# 		db.insert(i)
# 	except Exception as e:
# 		print(e)